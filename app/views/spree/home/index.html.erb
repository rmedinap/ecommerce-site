<% content_for :slide do %>
    <%= render :partial => 'spree/shared/slider' %>
<% end %>

<div data-hook="homepage_categories" class="container row">
  <% if @first_taxonomy.present? %>
    <% first_taxon   = @all_taxons.first
      last_taxon    = @all_taxons.last
    %>
    <% @all_taxons.each_slice(3) do |taxon_group| %>
      <% taxon_group.each_with_index do |taxon, i|
        if first_taxon    == taxon
          position = "alpha"
        elsif last_taxon  == taxon
          position = "omega"
        else
          position = ""
        end
      %>
        <div class="one-third column <%= position %>">
          <h2 class="<%= colors_array[i] %>"><%= line_break(taxon.try(:name)) %>       </h2>
          <div class="home_category_description">
            <%= taxon.try(:description) %>
          </div>
          <div class="home_category_products">
            <% taxon.products.limit(3).each do |p_product, p_i| %>
              <% p_position = ("alpha" if p_i==0) || ("omega" if p_i==2) || "" %>
              <div class="one-third column <%= p_position %>">
                <h3><%= p_product.try(:name) %><h3>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>

<div class="container linea">&nbsp;</div>

<div data-hook="homepage_prominent_products">
  <h2 class="green">Productos Destacados</h2>
  <%= render :partial => 'spree/shared/products_group_4', :locals => { :products => @products } %>
</div>

<div data-hook="homepage_products">
  <%# <%= render :partial => 'spree/shared/products', :locals => { :products => @products } %> %>
</div>

